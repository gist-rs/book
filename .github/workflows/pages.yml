name: Deploy static content to Pages

on: # This section is REQUIRED
  push:
    branches: ["main"]

  workflow_dispatch: # Allows manual triggering

  workflow_run:
    workflows: ["Mdbook build"]
    types:
      - completed

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Download artifact
        uses: dawidd6/action-download-artifact@v8
        with:
          name: book
          path: book/
          workflow: build.yml
          run_id: ${{ github.event.workflow_run.run_id }}

      - name: List files in book
        run: ls -l book/

      - name: Setup Pages
        uses: actions/configure-pages@v2

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: book

      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v1
